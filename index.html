# íŒ¨ì…˜ íŠ¸ë Œë“œ ê¸°ë°˜ ì½”ë”” ì¶”ì²œ ì‹œìŠ¤í…œ (Colab í™•ì¥ ë²„ì „)
# ì²´í˜•, ì„±ë³„ ê¸°ë°˜ + ì´ë¯¸ì§€ ì‹œê°í™” í¬í•¨

from datetime import datetime
from typing import List, Dict
from IPython.display import Image, display
import random

# -----------------------------
# íŠ¸ë Œë“œ í‚¤ì›Œë“œ í™•ì¥
# -----------------------------
trend_pool = [
    "ë¼ë²¤ë”", "Y2K", "ìŠ¤íŠ¸ë¦¿ì›¨ì–´", "ì—ì½”íŒ¨ì…˜", "ë°ë‹˜", "ì˜¬ë¦¬ë¸Œê·¸ë¦°", "í´ë˜ì‹", "í”Œë¡œëŸ´",
    "ì‹œìŠ¤ë£¨", "í¬ë¡­íƒ‘", "ì‹¤í‚¤ ì…”ì¸ ", "ë¡±ìŠ¤ì»¤íŠ¸", "ì¹´ê³ íŒ¬ì¸ ", "ì˜¤ë²„ì‚¬ì´ì¦ˆ ì¬í‚·", "ë ˆë” ì•„ì´í…œ",
    "ì½”ì–´ ì½”ì§€", "í…Œí¬ì›¨ì–´", "ì‹œí‹°ë³´ì´ë£©", "ë§¤íŠ¸ë¦­ìŠ¤ë£©", "ì•„ì¹´ë°ë¯¸ë£©", "ë‰´íŠ¸ëŸ´í†¤", "ë©”íƒˆë¦­",
    "ë³µê³ í’", "ë¯¼ì†Œë§¤ ì…‹ì—…", "ë²¨íŠ¸ í¬ì¸íŠ¸", "ë ˆì´ì–´ë“œ ë‹ˆíŠ¸", "í•˜í”„ ì§‘ì—…", "ë°”ì´ì»¤ ì‡¼ì¸ ",
    "í”Œë¦¬ì¸ ", "í¼í”„ì†Œë§¤", "í¬ë§í´ ì†Œì¬", "ë°±ë¦¬ìŠ¤", "ìŠ¤í¬í‹° ë¯¹ìŠ¤", "ë²„ë®¤ë‹¤íŒ¬ì¸ "
]

# -----------------------------
# íŠ¸ë Œë“œ í‚¤ì›Œë“œ â†’ ì´ë¯¸ì§€ ë§¤í•‘
# -----------------------------
trend_image_map = {
    "ë¼ë²¤ë”": "https://raw.githubusercontent.com/angeloyeo/fashion-ai-demo/main/img/lavender_ì—¬ì„±.jpg",
    "Y2K": "https://raw.githubusercontent.com/angeloyeo/fashion-ai-demo/main/img/y2k_ì—¬ì„±.jpg",
    "ìŠ¤íŠ¸ë¦¿ì›¨ì–´": "https://raw.githubusercontent.com/angeloyeo/fashion-ai-demo/main/img/street_ì—¬ì„±.jpg",
    "ì—ì½”íŒ¨ì…˜": "https://raw.githubusercontent.com/angeloyeo/fashion-ai-demo/main/img/eco_ì—¬ì„±.jpg",
    "ë°ë‹˜": "https://i.pinimg.com/originals/5d/20/77/5d2077c6e6fa489db4aa98e1ef9827d5.jpg",
    "ì˜¤ë²„ì‚¬ì´ì¦ˆ ì¬í‚·": "https://i.pinimg.com/originals/f9/cc/4e/f9cc4e40b3e9ff8b65aa6e3d9c4a6d17.jpg",
    "ì‹œìŠ¤ë£¨": "https://img.hankyung.com/photo/202304/01.33130631.1.jpg",
    "í¬ë¡­íƒ‘": "https://images.unsplash.com/photo-1618354691278-faa89ff3dfaa",
    "ë¡±ìŠ¤ì»¤íŠ¸": "https://img.musinsa.com/images/cate/202303/longskirt.jpg",
    "ì¹´ê³ íŒ¬ì¸ ": "https://i.pinimg.com/originals/5b/c9/70/5bc970f0bc0c9f67be18d156ad2708c6.jpg",
    "ì½”ì–´ ì½”ì§€": "https://i.pinimg.com/originals/56/47/2b/56472b58020b2a04c41d1ef18c536f6d.jpg",
    "ë©”íƒˆë¦­": "https://www.vogue.co.kr/wp-content/uploads/2023/10/style_6524fce70e037-790x1024.jpg",
    "ë³µê³ í’": "https://cdn.imweb.me/upload/S202208023292e9d9dc224/f07108fa3c302ff628f6d880b2f2ef94.jpg",
    "ì‹œí‹°ë³´ì´ë£©": "https://i.pinimg.com/736x/23/63/e5/2363e5d0cb7fa4e7b8aaed0c48a3cb92.jpg",
    "í…Œí¬ì›¨ì–´": "https://cdn.shopify.com/s/files/1/0027/6847/3474/files/techwear-style-guide.jpg"
}

# -----------------------------
# ì‚¬ìš©ì ì •ë³´ í´ë˜ìŠ¤
# -----------------------------
class UserProfile:
    def __init__(self, style: str, season: str, color: str,
                 height: int, weight: int, gender: str):
        self.style = style
        self.season = season
        self.color = color
        self.height = height
        self.weight = weight
        self.gender = gender

    def __repr__(self):
        return (f"[ì‚¬ìš©ì] ì„±ë³„: {self.gender}, í‚¤: {self.height}cm, ëª¸ë¬´ê²Œ: {self.weight}kg, "
                f"ìŠ¤íƒ€ì¼: {self.style}, ê³„ì ˆ: {self.season}, ìƒ‰ìƒ: {self.color}")

# -----------------------------
# íŠ¸ë Œë“œ í‚¤ì›Œë“œ ì„ íƒ
# -----------------------------
def get_today_trend_keywords() -> List[str]:
    return random.sample(trend_pool, 3)

# -----------------------------
# íŠ¸ë Œë“œ ì´ë¯¸ì§€ URL ë°˜í™˜
# -----------------------------
def get_image_url(keyword: str, gender: str) -> str:
    return trend_image_map.get(keyword, "https://raw.githubusercontent.com/angeloyeo/fashion-ai-demo/main/img/default_ì—¬ì„±.jpg")

# -----------------------------
# ì¶”ì²œ ìƒì„± í•¨ìˆ˜
# -----------------------------
def recommend_outfit(user: UserProfile, trend_keywords: List[str]) -> Dict:
    top = f"{trend_keywords[0]} ìŠ¤íƒ€ì¼ {user.color} ë¸”ë¼ìš°ìŠ¤"

    # ì²´í˜• ê¸°ë°˜ í•˜ì˜ ì¶”ì²œ
    if user.height < 160:
        bottom = "ë¯¸ë”” ê¸°ì¥ì˜ í”Œë ˆì–´ ìŠ¤ì»¤íŠ¸"
    elif user.height > 175:
        bottom = "ë¡± ë¶€ì¸ ì»· ë°ë‹˜ íŒ¬ì¸ "
    else:
        bottom = "ê¸°ë³¸ í• ìŠ¬ë™ìŠ¤"

    # ì²´ì¤‘ ê¸°ë°˜ ì•…ì„¸ì„œë¦¬ ì¶”ì²œ
    if user.weight >= 80:
        accessory = "ì˜¤ë²„ì‚¬ì´ì¦ˆ ìˆ„ë”ë°±"
    else:
        accessory = "ë¯¸ë‹ˆ í¬ë¡œìŠ¤ë°±"

    image_url = get_image_url(trend_keywords[0], user.gender)

    return {
        "top": top,
        "bottom": bottom,
        "accessory": accessory,
        "image_url": image_url,
        "trend_keywords": trend_keywords,
        "timestamp": datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    }

# -----------------------------
# ì‹¤í–‰ í•¨ìˆ˜
# -----------------------------
def run_demo():
    user = UserProfile(style="ìŠ¤íŠ¸ë¦¿", season="ë´„", color="ë¼ë²¤ë”", height=158, weight=50, gender="ì—¬ì„±")
    trend_keywords = get_today_trend_keywords()
    outfit = recommend_outfit(user, trend_keywords)

    print("âœ… ì‚¬ìš©ì ì •ë³´:")
    print(user)
    print("\nğŸ“Œ ì¶”ì²œ ì½”ë””:")
    print(f"  Top        : {outfit['top']}")
    print(f"  Bottom     : {outfit['bottom']}")
    print(f"  Accessory  : {outfit['accessory']}")
    print(f"  Trend Tags : {', '.join(outfit['trend_keywords'])}")
    print(f"  Timestamp  : {outfit['timestamp']}")

    print("\nğŸ–¼ï¸ ì¶”ì²œ ì´ë¯¸ì§€:")
    display(Image(url=outfit["image_url"]))

# -----------------------------
# ì‹¤í–‰
# -----------------------------
run_demo()
